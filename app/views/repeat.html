<div class="container-fluid">
	<h1 class="page-header">Repeats<span ng-if="is_admin"> - Admin View</span></h1>
	<div ng-if="error">{{error}}</div>
	<div class="form-wrap" ng-if="searchDisplay">
		<form>
			<div class="row" style="padding-bottom:10px;">
				<div style="float:left;padding-left:20px">
					<label for="last_due_date">All</label><br />
					<input type="checkbox" name="last_due_date" ng-model="search.last_due_date" ng-change="refreshData()" />
				</div>
				<div class="col-sm-2">
					<label for="name">Text Search</label>
					<input type="text" class="form-control input-sm search" name="name" data-length="4" ng-model="search.name" ng-change="refreshData()" />
				</div>
				<div class="col-sm-2">
					<label for="category">Category</label>
					<select class="form-control" name="category" ng-model="search.category_id" ng-options="category.id as category.name for category in categories" ng-change="refreshData()">
						<option value="">Select Category</option>
					</select>
				</div>
				<div class="col-sm-2">
					<label for="bank_account_id">Account</label>
					<select class="form-control" name="bank_account_id" ng-model="search.bank_account_id" ng-options="account.id as account.name for account in active_accounts" ng-change="refreshData()">
						<option value="">Select Account</option>
					</select>
				</div>
				<div class="col-sm-1">
					<label for="amount">Amount</label>
					<input type="text" class="form-control input-sm search" name="amount" data-length="4" ng-model="search.amount" ng-change="refreshData()" />
				</div>
				<div class="col-sm-1" style="padding-top:20px;">
					<button type="button" class="btn-sm btn-primary" ng-model="singleModel" ng-click="addRepeat()">New</button>
				</div>
			</div>
		</form>
	</div>
	<div class="table-responsive table-lg" ng-if="!dataErrorMsg[0] && !error">
		<table>
			<thead>
				<tr>
					<th style="width:250px !important;">Vendor/Description</th>
					<th style="width:40px !important;">Category</th>
					<th>Account</th>
					<th>First Due Date</th>
					<th>Next Due Date</th>
					<th>Last Due Date</th>
					<th>Every</th>
					<th>DEBIT</th>
					<th>CREDIT</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				<tr ng-show="repeats_seq.length > 0" ng-repeat="idx in repeats_seq">
					<td>
						{{ repeats[idx].vendor.name }}
						<span ng-if="repeats[idx].description" style="font-size: 10px"><br />{{ repeats[idx].description }}</span>
						<span ng-if="repeats[idx].notes" style="font-size: 10px"> - <em>{{ repeats[idx].notes }}</em></span>
					</td>
					<td><span class="pull-left">{{ repeats[idx].category.name }}</span></td>
					<td><span class="pull-left">{{ repeats[idx].bankName }}</td>
					<td><span class="pull-left">{{ repeats[idx].first_due_date|date:'EEE MMM dd, yyyy' }}</span></td>
					<td><span class="pull-left">{{ repeats[idx].next_due_date|date:'EEE MMM dd, yyyy' }}</span></td>
					<td><span class="pull-left">{{ repeats[idx].last_due_date|date:'EEE MMM dd, yyyy' }}</span></td>
					<td>{{ repeats[idx].every }} {{ repeats[idx].every_unit }}</td>
					<td><span class="pull-right" ng-if="forecasts[idx].type == 'CHECK' || repeats[idx].type == 'DEBIT' || repeats[idx].type == 'SALE'">{{ repeats[idx].amount|currency }}</span></td>
					<td><span class="pull-right" ng-if="repeats[idx].type == 'CREDIT' || repeats[idx].type == 'DSLIP' || repeats[idx].type == 'RETURN' || repeats[idx].type == 'PAYMENT'">{{ repeats[idx].amount|currency }}</span></td>
					<td>
						<span class="glyphicon glyphicon-pencil" ng-click="editRepeat(repeats[idx].id)" style="cursor:pointer;" title="Edit Repeat ?"></span>
						<span class="glyphicon glyphicon-trash" ng-click="deleteRepeat(repeats[idx].id)" style="cursor:pointer;" title="Delete Reapeat ?"></span>
					</td>
				</tr>
				<tr ng-show="repeats_seq.length == 0">
					<td colspan="10">No repeats found</td>
				</tr>
			</tbody>
		</table>
		<div ng-if="recCount > itemsPerPage">
			<div class="col-sm-12">
				<pagination boundary-links="true" max-size="maxSize" total-items="recCount" items-per-page="itemsPerPage" ng-model="search.currentPage"
					previous-text="&lsaquo;"  next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()"></pagination>
				<span style="vertical-align:middle;padding-left:40px;">Total records: {{recCount | number}}</span>
			</div>
		</div>
	</div>
	<div ng-if="dataErrorMsg[0]">
		<p class="text-muted" ng-repeat="error in dataErrorMsg">{{error}}</p>
	</div>
</div>
