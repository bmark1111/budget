<div class="container-fluid" style="line-height: 1.3"><!-- viewport-width>-->
	<div class="row">
		<div class="col-sm-2">
			<h1 class="page-header">Budget</h1>
		</div>
		<div class="col-sm-4" style="padding-top: 20px;">
			<div class="pull-left" style="cursor:pointer;" ng-click="moveInterval(-1)" title="Go back one period"><<<</div>
			<div class="pull-right" style="cursor:pointer;" ng-click="moveInterval(1)" title="Go forward one period">>>></div>
		</div>
		<div class="col-sm-6">
			<div ng-if="error">{{ error }}</div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-md-12">
			<div class="table-responsive table-lg" ng-if="!dataErrorMsg[0] && !error">
				<table class="dashboard">
					<thead>
						<tr>
							<th><span class="pull-right">Period Ending</span></th>
							<th style="text-align:center;" ng-repeat="period in periods|getIntervals:period_start" ng-class="{ 'currentInterval': period.current_interval }">
								<span>{{ period.interval_ending|displayDate:period.budget_mode }}</span>
							</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th nowrap>Balance Forward</th>
							<td ng-repeat="period in periods|getIntervals:period_start" nowrap ng-class="{ 'currentInterval': period.current_interval }" style="padding:2px!important;">
								<span class="pull-right" ng-if="$index == 0">{{ period.balance_forward|currency }}</span>
							</td>
						</tr>
						<tr ng-repeat="category in categories track by $index" ng-show="category.id != 17 && showCategory[category.id]">
							<th style="padding:2px!important;">{{ category.name }}</th>
							<td ng-repeat="period in periods|getIntervals:period_start" nowrap ng-class="{ 'currentInterval': period.current_interval }" id="popover_{{ $index }}_{{ category.id }}">
								<div class="pull-right">
									<span ng-if="period.types[category.id] >= 0" ng-init="showCategory[category.id] = true">
										<a ng-class="{ 'forecast_amount':period.types[category.id] == 2 || period.types[category.id] == 6,
														'actual_and_forecast_amount':period.types[category.id] == 3,
														'repeat_amount':period.types[category.id] == 4 || period.types[category.id] == 5 || period.types[category.id] == 7 }"
											ns-popover="showTheseTransactions(category.id, $index, category.name, period.types[category.id])"
											ns-popover-placement="right"
											ns-popover-template="app/views/templates/popover.html"
											ns-popover-trigger="click"
											ns-popover-theme="ns-popover-custom-theme"
											ns-popover-timeout="0">
											{{ period.totals[category.id]|currency }}
										</a>
									</span>
								</div>
							</td>
						</tr>
					</tbody>
					<tfoot>
						<tr>
							<th nowrap>Totals</th>
							<td ng-repeat="period in periods|getIntervals:period_start" nowrap ng-class="{ 'currentInterval': period.current_interval }" style="padding:2px!important;">
								<span class="pull-right">{{ period.interval_total|currency }}</span>
							</td>
						</tr>
						<tr>
							<th nowrap>Running Totals</th>
							<td ng-repeat="period in periods|getIntervals:period_start" nowrap ng-class="{ 'currentInterval': period.current_interval }" style="padding:2px!important;">
								<span class="pull-right">{{ period.running_total|currency }}</span>
							</td>
						</tr>
						<tr>
							<th class="transfer_amount" nowrap>Transfers/Payments</th>
							<td ng-repeat="period in periods|getIntervals:period_start" nowrap ng-class="{ 'currentInterval': period.current_interval }" style="padding:2px!important;" class="transfer_amount">
								<div class="pull-right">
									<span ng-if="period.transfer_amount > 0">
										<a tooltip="Account Transfers"
											ns-popover="showTheseTransactions(17, $index, 'Transfers', period.types[category.id])"
											ns-popover-placement="right"
											ns-popover-template="app/views/templates/popover2.html"
											ns-popover-trigger="click"
											ns-popover-theme="ns-popover-custom-theme"
											ns-popover-timeout="0">
											{{ period.transfer_amount|currency }}
										</a>
									</span>
								</div>
							</td>
						</tr>
						<tr ng-repeat="account in accounts track by $index">
							<td class="banks" nowrap>{{ account.name }}</td>
							<td class="balances" ng-repeat="period in periods|getIntervals:period_start" nowrap ng-class="{ 'currentInterval': period.current_interval }" style="padding:2px!important;">
								<span ng-show="period.accounts[$parent.$index].reconciled == 0" class="pull-right forecast_amount">
									{{ period.accounts[$parent.$index].balance|currency }}
								</span>
								<button ng-show="period.accounts[$parent.$index].reconciled == 1" type="button" class="pull-right" style="width:74px;margin:0;padding:0;"
												title="Click to Reconcile {{ account.name }} Account">
									<span class="pull-right" style="margin:0;padding:0;" ng-click="reconcile(account, period, $parent.$index)">
										{{ period.accounts[$parent.$index].balance|currency }}
									</span>
								</button>
								<span ng-show="period.accounts[$parent.$index].reconciled == 2" class="pull-right" title="{{ account.name }} is reconciled">
									<img ng-src="app/images/transparent-green-checkmark-th.png" height="12" width="8" />
									{{ period.accounts[$parent.$index].balance|currency }}
								</span>
								<span ng-show="period.accounts[$parent.$index].reconciled == 3" class="pull-right">
									{{ period.accounts[$parent.$index].balance|currency }}
								</span>
								<span ng-show="period.accounts[$parent.$index].reconciled == 99" class="pull-right">
									N/A
								</span>
							</td>
						</tr>
					</tfoot>
				</table>
			</div>
		</div>
	</div>
	<div ng-if="dataErrorMsg[0]">
		<p class="text-muted" ng-repeat="error in dataErrorMsg">{{ error }}</p>
	</div>
</div>
