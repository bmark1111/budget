SELECT T.transaction_date,
	SUM(CASE WHEN T.category_id = 22 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END)
  + SUM(CASE WHEN T.category_id = 22 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END)
  + SUM(CASE WHEN TS.category_id = 22 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END)
  + SUM(CASE WHEN TS.category_id = 22 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_22_credit,
  - SUM(CASE WHEN T.category_id = 22 AND T.type = 'CHECK' THEN T.amount ELSE 0 END)
  - SUM(CASE WHEN T.category_id = 22 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)
  - SUM(CASE WHEN TS.category_id = 22 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END)
  - SUM(CASE WHEN TS.category_id = 22 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_22_debit,
	SUM(CASE WHEN T.category_id = 13 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END)
	+ SUM(CASE WHEN T.category_id = 13 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END)
	+ SUM(CASE WHEN TS.category_id = 13 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END)
	+ SUM(CASE WHEN TS.category_id = 13 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END) AS total_13_credit,
	- SUM(CASE WHEN T.category_id = 13 AND T.type = 'CHECK' THEN T.amount ELSE 0 END)
	- SUM(CASE WHEN T.category_id = 13 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)
	- SUM(CASE WHEN TS.category_id = 13 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END)
	- SUM(CASE WHEN TS.category_id = 13 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_13_debit,
	SUM(CASE WHEN T.category_id = 14 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END)
	+ SUM(CASE WHEN T.category_id = 14 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END
	+ SUM(CASE WHEN TS.category_id = 14 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END)
	+ SUM(CASE WHEN TS.category_id = 14 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END) AS total_14_credit,
	- SUM(CASE WHEN T.category_id = 14 AND T.type = 'CHECK' THEN T.amount ELSE 0 END)
	- SUM(CASE WHEN T.category_id = 14 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)
	- SUM(CASE WHEN TS.category_id = 14 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END)
	- SUM(CASE WHEN TS.category_id = 14 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_14_debit,
	SUM(CASE WHEN T.category_id = 17 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END)
	+ SUM(CASE WHEN T.category_id = 17 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END)
	+ SUM(CASE WHEN TS.category_id = 17 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END)
	+ SUM(CASE WHEN TS.category_id = 17 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_17_credit,
	- SUM(CASE WHEN T.category_id = 17 AND T.type = 'CHECK' THEN T.amount ELSE 0 END)
	- SUM(CASE WHEN T.category_id = 17 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)
	- SUM(CASE WHEN TS.category_id = 17 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END)
	- SUM(CASE WHEN TS.category_id = 17 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_17_debit,
	SUM(CASE WHEN T.category_id = 10 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END)
	+ SUM(CASE WHEN T.category_id = 10 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END)
	+ SUM(CASE WHEN TS.category_id = 10 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END)
	+ SUM(CASE WHEN TS.category_id = 10 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_10_credit,
	- SUM(CASE WHEN T.category_id = 10 AND T.type = 'CHECK' THEN T.amount ELSE 0 END)
	- SUM(CASE WHEN T.category_id = 10 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)
	- SUM(CASE WHEN TS.category_id = 10 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END)
	- SUM(CASE WHEN TS.category_id = 10 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_10_debit,
	SUM(CASE WHEN T.category_id = 18 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END)
	+ SUM(CASE WHEN T.category_id = 18 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 18 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 18 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_18_credit, - SUM(CASE WHEN T.category_id = 18 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 18 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 18 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 18 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_18_debit,SUM(CASE WHEN T.category_id = 16 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 16 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 16 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 16 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_16_credit, - SUM(CASE WHEN T.category_id = 16 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 16 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 16 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 16 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_16_debit,SUM(CASE WHEN T.category_id = 15 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 15 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 15 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 15 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_15_credit, - SUM(CASE WHEN T.category_id = 15 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 15 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 15 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 15 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_15_debit,SUM(CASE WHEN T.category_id = 19 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 19 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 19 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 19 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_19_credit, - SUM(CASE WHEN T.category_id = 19 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 19 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 19 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 19 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_19_debit,SUM(CASE WHEN T.category_id = 21 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 21 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 21 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 21 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_21_credit, - SUM(CASE WHEN T.category_id = 21 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 21 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 21 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 21 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_21_debit,SUM(CASE WHEN T.category_id = 12 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 12 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 12 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 12 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_12_credit, - SUM(CASE WHEN T.category_id = 12 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 12 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 12 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 12 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_12_debit,SUM(CASE WHEN T.category_id = 11 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 11 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 11 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 11 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_11_credit, - SUM(CASE WHEN T.category_id = 11 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 11 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 11 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 11 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_11_debit,SUM(CASE WHEN T.category_id = 9 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 9 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 9 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 9 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_9_credit, - SUM(CASE WHEN T.category_id = 9 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 9 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 9 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 9 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_9_debit,SUM(CASE WHEN T.category_id = 8 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 8 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 8 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 8 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_8_credit, - SUM(CASE WHEN T.category_id = 8 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 8 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 8 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 8 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_8_debit,SUM(CASE WHEN T.category_id = 7 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 7 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 7 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 7 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_7_credit, - SUM(CASE WHEN T.category_id = 7 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 7 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 7 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 7 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_7_debit,SUM(CASE WHEN T.category_id = 6 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 6 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 6 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 6 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_6_credit, - SUM(CASE WHEN T.category_id = 6 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 6 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 6 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 6 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_6_debit,SUM(CASE WHEN T.category_id = 5 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 5 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 5 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 5 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_5_credit, - SUM(CASE WHEN T.category_id = 5 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 5 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 5 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 5 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_5_debit,SUM(CASE WHEN T.category_id = 4 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 4 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 4 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 4 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_4_credit, - SUM(CASE WHEN T.category_id = 4 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 4 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 4 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 4 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_4_debit,SUM(CASE WHEN T.category_id = 3 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 3 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 3 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 3 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_3_credit, - SUM(CASE WHEN T.category_id = 3 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 3 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 3 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 3 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_3_debit,SUM(CASE WHEN T.category_id = 2 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 2 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 2 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 2 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_2_credit, - SUM(CASE WHEN T.category_id = 2 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 2 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 2 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 2 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_2_debit,SUM(CASE WHEN T.category_id = 1 AND T.type = 'CREDIT' THEN T.amount ELSE 0 END) + SUM(CASE WHEN T.category_id = 1 AND T.type = 'DSLIP' THEN T.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 1 AND TS.type = 'CREDIT' THEN TS.amount ELSE 0 END) + SUM(CASE WHEN TS.category_id = 1 AND TS.type = 'DSLIP' THEN TS.amount ELSE 0 END)AS total_1_credit, - SUM(CASE WHEN T.category_id = 1 AND T.type = 'CHECK' THEN T.amount ELSE 0 END) - SUM(CASE WHEN T.category_id = 1 AND T.type = 'DEBIT' THEN T.amount ELSE 0 END)  - SUM(CASE WHEN TS.category_id = 1 AND TS.type = 'CHECK' THEN TS.amount ELSE 0 END) - SUM(CASE WHEN TS.category_id = 1 AND TS.type = 'DEBIT' THEN TS.amount ELSE 0 END) AS total_1_debit
FROM transaction T
LEFT JOIN transaction_split TS ON TS.transaction_id = T.id AND TS.is_deleted = 0
WHERE T.transaction_date >= '2016-01-01' AND T.transaction_date < '2017-01-01' AND T.is_deleted = 0
GROUP BY YEAR(T.transaction_date), MONTH(T.transaction_date)
ORDER BY YEAR(T.transaction_date), MONTH(T.transaction_date) ASC
